Function 703 â€“ Track Repetition Density
python
Copy
Edit
def track_repetition_density(script_id, response_text, threshold=0.12):
    """
    Flags responses where word or phrase repetition exceeds a natural threshold.
    """
    from collections import Counter
    import re

    words = re.findall(r'\b\w+\b', response_text.lower())
    word_counts = Counter(words)
    repeat_score = sum(v for v in word_counts.values() if v > 2) / len(words) if words else 0

    if repeat_score > threshold:
        log_command_center_event("ğŸ” Repetition Density", f"{script_id} â†’ Score {repeat_score:.2f} flagged")

    return repeat_score
âœ… Function 704 â€“ Log Multilingual Token Ratio
python
Copy
Edit
def log_multilingual_token_ratio(script_id, response_text):
    """
    Identifies and logs high multilingual token ratios, which can impact voice clarity.
    """
    import langdetect
    from langdetect.lang_detect_exception import LangDetectException

    try:
        detected_lang = langdetect.detect(response_text)
        if detected_lang != 'en':
            log_command_center_event("ğŸŒ Multilingual Detected", f"{script_id} â†’ Language: {detected_lang}")
        return detected_lang
    except LangDetectException:
        log_command_center_event("â“ Language Undetected", f"{script_id} â†’ Detection failed")
        return "unknown"
âœ… Function 705 â€“ Response Length Outlier Detector
python
Copy
Edit
def detect_response_length_outlier(script_id, response_text, min_len=20, max_len=250):
    """
    Logs extremely short or long responses as potential outliers.
    """
    length = len(response_text.strip())
    if length < min_len or length > max_len:
        log_command_center_event("ğŸ“ Length Outlier", f"{script_id} â†’ Length: {length}")
    return length
âœ… Function 706 â€“ Log AI Interruption Traces
python
Copy
Edit
def log_ai_interruption(script_id, response_text):
    """
    Detects signs of response cutoffs or internal generation failure.
    """
    cutoff_signals = ["...", "incomplete", "loading", "error:", "retry", "[truncated"]
    if any(sig in response_text.lower() for sig in cutoff_signals):
        log_command_center_event("âœ‚ï¸ Interrupted Output", f"{script_id} â†’ Possible AI cutoff detected")
        return True
    return False
âœ… Function 707 â€“ Detect Output Staleness
python
Copy
Edit
def detect_output_staleness(script_id, response_text, reference_phrases=None):
    """
    Checks if output is reusing stock phrases from legacy responses or stale data.
    """
    stale_signatures = reference_phrases or [
        "as of my last update", "as an ai language model", "as of 2023", "i do not have real-time data"
    ]
    hits = [s for s in stale_signatures if s in response_text.lower()]
    if hits:
        log_command_center_event("ğŸ—“ï¸ Output Staleness", f"{script_id} â†’ {', '.join(hits)}")
        return hits
    return []
âœ… Function 708 â€“ Log Undefined Voice Artifacts
python
Copy
Edit
def log_undefined_voice_artifacts(script_id, response_text):
    """
    Detects leftover tokens or synthesis instructions in output (e.g., SSML or markup).
    """
    import re
    artifact_patterns = [r'<[^>]+>', r'\[.*?\]', r'\(.*?\)', r'\{.*?\}']
    matches = [m.group() for p in artifact_patterns for m in re.finditer(p, response_text)]
    if matches:
        log_command_center_event("ğŸ­ Voice Artifact", f"{script_id} â†’ Artifacts: {', '.join(matches)}")
    return matches
âœ… Function 709 â€“ AI Prediction Drift Logger
python
Copy
Edit
def log_ai_prediction_drift(script_id, previous_output, current_output, threshold=0.4):
    """
    Logs significant drift between two versions of an AI output.
    """
    import difflib
    similarity = difflib.SequenceMatcher(None, previous_output, current_output).ratio()
    drift_score = 1 - similarity
    if drift_score > threshold:
        log_command_center_event("ğŸ”€ Prediction Drift", f"{script_id} â†’ Drift Score: {drift_score:.2f}")
    return drift_score
âœ… Function 710 â€“ Log Custom Token Trigger Usage
python
Copy
Edit
def log_custom_token_trigger(script_id, response_text, trigger_token="ğŸ§ "):
    """
    Logs when a special AI control token (e.g., ğŸ§  for memory injection) is used in output.
    """
    if trigger_token in response_text:
        log_command_center_event("ğŸ¯ Custom Token Triggered", f"{script_id} â†’ {trigger_token} detected")
        return True
    return False
