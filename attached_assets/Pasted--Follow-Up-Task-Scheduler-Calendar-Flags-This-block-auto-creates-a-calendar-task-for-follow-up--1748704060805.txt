ğŸ—“ï¸ Follow-Up Task Scheduler (Calendar Flags)
This block auto-creates a calendar task for follow-up, based on contact type or trigger logic (e.g. no deal closed, â€œwarmâ€ lead, etc.).

ğŸ”§ Function: scheduleFollowUpTask(contact)
js
Copy
Edit
async function scheduleFollowUpTask(contact) {
  const summary = `âœ… Follow-Up: ${contact.firstName} ${contact.lastName}`;
  const description = `Check in with ${contact.firstName} from ${contact.company || "unknown company"}. Email: ${contact.email}`;
  const startTime = new Date(Date.now() + 3 * 24 * 60 * 60 * 1000); // 3 days from now

  const event = {
    summary,
    description,
    start: {
      dateTime: startTime.toISOString(),
      timeZone: "America/Phoenix"
    },
    end: {
      dateTime: new Date(startTime.getTime() + 30 * 60000).toISOString(),
      timeZone: "America/Phoenix"
    }
  };

  await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events", {
    method: "POST",
    headers: {
      Authorization: `Bearer ${process.env.GOOGLE_CALENDAR_TOKEN}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify(event)
  });

  console.log("ğŸ“… Follow-up task scheduled in Google Calendar");
}
ğŸ” Requires GOOGLE_CALENDAR_TOKEN â€” confirm it's refreshed for long-term use.

âœ… STEP 8: âœ… Completion Flag â†’ Update Contact Record
This flag marks the contact as â€œCompletedâ€ in Airtable once all steps are successful (quote sent, Slack alert sent, etc.).

ğŸ”§ Function: markContactComplete(contact)
js
Copy
Edit
async function markContactComplete(contact) {
  await fetch(`https://api.airtable.com/v0/${process.env.AIRTABLE_BASE}/Contacts`, {
    method: "PATCH",
    headers: {
      Authorization: `Bearer ${process.env.AIRTABLE_KEY}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      records: [
        {
          id: contact.airtableRecordId,
          fields: {
            "âœ… Completed": true,
            "ğŸ•“ Completed At": new Date().toISOString()
          }
        }
      ]
    })
  });

  console.log("âœ… Contact marked complete in Airtable");
}